<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–ø–∏—Å–æ–∫ –∏–≥—Ä</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 20px;
        }
        .game-item {
            border: 1px solid #ddd;
            margin: 10px 0;
            padding: 15px;
            border-radius: 4px;
            background-color: #fafafa;
        }
        .game-id {
            font-weight: bold;
            color: #666;
            margin-bottom: 5px;
        }
        .game-title {
            color: #333;
            font-size: 1.1em;
            margin-bottom: 10px;
        }
        .game-button {
            background-color: #00a2ff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            text-decoration: none;
            display: inline-block;
            transition: background-color 0.3s;
            font-weight: bold;
        }
        .game-button:hover {
            background-color: #0078cc;
        }
        .loading {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 20px;
        }
        .error {
            color: #d32f2f;
            background-color: #ffebee;
            padding: 15px;
            border-radius: 4px;
            border: 1px solid #f44336;
            margin: 10px 0;
        }
        .success {
            color: #2e7d32;
            background-color: #e8f5e9;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #4caf50;
            margin: 10px 0;
        }
        .button-container {
            margin-top: 10px;
            text-align: center;
        }
        .retry-button {
            background-color: #ff9800;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
        pre {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 3px;
            overflow-x: auto;
            max-height: 300px;
            overflow-y: auto;
            font-size: 12px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ –°–ø–∏—Å–æ–∫ –∏–≥—Ä Roblox</h1>
        <div id="status"></div>
        <div id="games-list">
            <div class="loading">üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
        </div>
        <div id="controls" style="text-align: center; margin-top: 20px;">
            <button class="retry-button" onclick="loadGames()">üîÑ –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É</button>
            <button class="retry-button" onclick="loadManualData()">üìã –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</button>
            <button class="retry-button" onclick="showRawData()">üîç –ü–æ–∫–∞–∑–∞—Ç—å —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ</button>
        </div>
        <div id="raw-data" style="display: none; margin-top: 20px;"></div>
    </div>

    <script>
        let rawResponseData = '';

        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : 'loading';
            statusDiv.innerHTML = `<div class="${className}">${message}</div>`;
        }

        function showRawData() {
            const rawDataDiv = document.getElementById('raw-data');
            if (rawDataDiv.style.display === 'none') {
                rawDataDiv.innerHTML = `
                    <h3>üîç –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞:</h3>
                    <pre>${rawResponseData}</pre>
                    <button class="retry-button" onclick="analyzeData()">üìä –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É</button>
                `;
                rawDataDiv.style.display = 'block';
            } else {
                rawDataDiv.style.display = 'none';
            }
        }

        function analyzeData() {
            const rawDataDiv = document.getElementById('raw-data');
            let analysis = '<h3>üìä –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö:</h3>';
            
            // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É
            analysis += '<h4>–ü–µ—Ä–≤—ã–µ 1000 —Å–∏–º–≤–æ–ª–æ–≤:</h4><pre>' + rawResponseData.substring(0, 1000) + '</pre>';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
            const hasId = rawResponseData.includes('"id"');
            const hasTitle = rawResponseData.includes('"title"');
            const hasGames = rawResponseData.includes('"games"');
            const hasData = rawResponseData.includes('"data"');
            
            analysis += '<h4>–ù–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–ª–µ–π:</h4>';
            analysis += `<ul>
                <li>${hasId ? '‚úÖ' : '‚ùå'} –ü–æ–ª–µ "id"</li>
                <li>${hasTitle ? '‚úÖ' : '‚ùå'} –ü–æ–ª–µ "title"</li>
                <li>${hasGames ? '‚úÖ' : '‚ùå'} –ü–æ–ª–µ "games"</li>
                <li>${hasData ? '‚úÖ' : '‚ùå'} –ü–æ–ª–µ "data"</li>
            </ul>`;
            
            // –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ JSON –æ–±—ä–µ–∫—Ç—ã
            const jsonObjects = rawResponseData.match(/\{[^{}]*\}/g);
            analysis += `<h4>–ù–∞–π–¥–µ–Ω–æ JSON –æ–±—ä–µ–∫—Ç–æ–≤: ${jsonObjects ? jsonObjects.length : 0}</h4>`;
            
            if (jsonObjects) {
                analysis += '<h4>–ü—Ä–∏–º–µ—Ä—ã –æ–±—ä–µ–∫—Ç–æ–≤:</h4>';
                jsonObjects.slice(0, 3).forEach((obj, i) => {
                    analysis += `<pre>–û–±—ä–µ–∫—Ç ${i + 1}: ${obj}</pre>`;
                });
            }
            
            rawDataDiv.innerHTML += analysis;
        }

        // –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è JSON
        function fixJSON(text) {
            console.log('–ò—Å–ø—Ä–∞–≤–ª—è–µ–º JSON...');
            
            // –ü—Ä–æ—Å—Ç—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            let fixed = text
                .replace(/,\s*([}\]])/g, '$1') // –£–±–∏—Ä–∞–µ–º –∑–∞–ø—è—Ç—ã–µ –ø–µ—Ä–µ–¥ } –∏ ]
                .replace(/(\w+):/g, '"$1":')   // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞–≤—ã—á–∫–∏ –∫ –∫–ª—é—á–∞–º
                .replace(/'/g, '"')            // –ó–∞–º–µ–Ω—è–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
                .replace(/:\s*([a-zA-Z_][a-zA-Z0-9_]*)(?=\s*[,\]}])/g, ':"$1"'); // –ö–∞–≤—ã—á–∫–∏ –¥–ª—è —Å—Ç—Ä–æ–∫ –±–µ–∑ –∫–∞–≤—ã—á–µ–∫
            
            return fixed;
        }

        // –ü–∞—Ä—Å–∏–Ω–≥ —á–µ—Ä–µ–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑
        function parseTextData(text) {
            console.log('–ü–∞—Ä—Å–∏–º –∫–∞–∫ —Ç–µ–∫—Å—Ç...');
            const games = [];
            
            // –ò—â–µ–º –≤—Å–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è id –∏ title
            const idMatches = text.match(/"id"\s*:\s*(\d+)/g);
            const titleMatches = text.match(/"title"\s*:\s*"([^"]*)"/g);
            
            if (idMatches && titleMatches) {
                console.log(`–ù–∞–π–¥–µ–Ω–æ ID: ${idMatches.length}, Title: ${titleMatches.length}`);
                
                // –°–æ–∑–¥–∞–µ–º –ø–∞—Ä—ã id-title
                for (let i = 0; i < Math.min(idMatches.length, titleMatches.length); i++) {
                    const idMatch = idMatches[i].match(/"id"\s*:\s*(\d+)/);
                    const titleMatch = titleMatches[i].match(/"title"\s*:\s*"([^"]*)"/);
                    
                    if (idMatch && titleMatch) {
                        games.push({
                            id: parseInt(idMatch[1]),
                            title: titleMatch[1]
                        });
                    }
                }
            }
            
            return games;
        }

        async function loadGames() {
            const gamesList = document.getElementById('games-list');
            const targetUrl = 'https://games.synt2x.xyz/v1/games/';
            
            updateStatus('üîÑ –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É...');
            gamesList.innerHTML = '<div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>';
            document.getElementById('raw-data').style.display = 'none';
            
            try {
                const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(targetUrl);
                
                const response = await fetch(proxyUrl);
                
                if (!response.ok) {
                    throw new Error(`HTTP error: ${response.status}`);
                }
                
                const text = await response.text();
                rawResponseData = text;
                console.log('–ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ:', text);
                
                processGamesData(text, gamesList);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                updateStatus('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + error.message, 'error');
                gamesList.innerHTML = `
                    <div class="error">
                        –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. –û—à–∏–±–∫–∞: ${error.message}
                    </div>
                `;
            }
        }

        function processGamesData(text, gamesList) {
            try {
                let games = [];
                
                // –ú–µ—Ç–æ–¥ 1: –ü—Ä—è–º–æ–π JSON –ø–∞—Ä—Å–∏–Ω–≥
                try {
                    const data = JSON.parse(text);
                    games = extractGamesFromData(data);
                    console.log('‚úÖ –ú–µ—Ç–æ–¥ 1: –ü—Ä—è–º–æ–π –ø–∞—Ä—Å–∏–Ω–≥ - –Ω–∞–π–¥–µ–Ω–æ –∏–≥—Ä:', games.length);
                } catch (e1) {
                    console.log('–ú–µ—Ç–æ–¥ 1 –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª:', e1.message);
                    
                    // –ú–µ—Ç–æ–¥ 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π JSON
                    try {
                        const fixedText = fixJSON(text);
                        const data = JSON.parse(fixedText);
                        games = extractGamesFromData(data);
                        console.log('‚úÖ –ú–µ—Ç–æ–¥ 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π JSON - –Ω–∞–π–¥–µ–Ω–æ –∏–≥—Ä:', games.length);
                    } catch (e2) {
                        console.log('–ú–µ—Ç–æ–¥ 2 –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª:', e2.message);
                        
                        // –ú–µ—Ç–æ–¥ 3: –¢–µ–∫—Å—Ç–æ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥
                        games = parseTextData(text);
                        console.log('‚úÖ –ú–µ—Ç–æ–¥ 3: –¢–µ–∫—Å—Ç–æ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥ - –Ω–∞–π–¥–µ–Ω–æ –∏–≥—Ä:', games.length);
                    }
                }
                
                if (games.length === 0) {
                    gamesList.innerHTML = `
                        <div class="error">
                            ‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
                            <ul>
                                <li>–î–∞–Ω–Ω—ã–µ –≤ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ</li>
                                <li>–°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É</li>
                                <li>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–∏–ª–∞—Å—å</li>
                            </ul>
                            <br>
                            <strong>–ù–∞–∂–º–∏—Ç–µ "–ü–æ–∫–∞–∑–∞—Ç—å —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ" –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</strong>
                        </div>
                    `;
                    return;
                }
                
                displayGames(games, gamesList);
                updateStatus(`‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ ${games.length} –∏–≥—Ä`, 'success');
                
            } catch (error) {
                gamesList.innerHTML = `
                    <div class="error">
                        –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ${error.message}
                    </div>
                `;
            }
        }

        function extractGamesFromData(data) {
            let games = [];
            
            if (Array.isArray(data)) {
                games = data.filter(item => item && item.id);
            } else if (data && typeof data === 'object') {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
                if (data.games && Array.isArray(data.games)) {
                    games = data.games;
                } else if (data.data && Array.isArray(data.data)) {
                    games = data.data;
                } else if (data.items && Array.isArray(data.items)) {
                    games = data.items;
                } else {
                    // –ü—Ä–æ–±—É–µ–º –∏–∑–≤–ª–µ—á—å –∏–≥—Ä—ã –∏–∑ —Å–≤–æ–π—Å—Ç–≤ –æ–±—ä–µ–∫—Ç–∞
                    games = Object.values(data).filter(item => item && typeof item === 'object' && item.id);
                }
            }
            
            return games;
        }

        function displayGames(games, gamesList) {
            gamesList.innerHTML = '';
            
            games.sort((a, b) => a.id - b.id);
            
            games.forEach(game => {
                const gameElement = document.createElement('div');
                gameElement.className = 'game-item';
                
                const robloxUrl = `robloxmobile://Game/PlaceLauncher.ashx?request=RequestGame&placeId=${game.id}`;
                
                gameElement.innerHTML = `
                    <div class="game-info">
                        <div class="game-id">üéØ ID: ${game.id}</div>
                        <div class="game-title">üéÆ ${game.title || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</div>
                        ${game.description ? `<div style="color: #666; font-size: 0.9em; margin-top: 5px;">üìù ${game.description}</div>` : ''}
                    </div>
                    <div class="button-container">
                        <a href="${robloxUrl}" class="game-button" onclick="handleGameLaunch(event, ${game.id})">
                            üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ Roblox
                        </a>
                    </div>
                `;
                gamesList.appendChild(gameElement);
            });
            
            const counter = document.createElement('div');
            counter.style.marginTop = '20px';
            counter.style.textAlign = 'center';
            counter.style.color = '#666';
            counter.innerHTML = `<strong>–í—Å–µ–≥–æ –∏–≥—Ä: ${games.length}</strong>`;
            gamesList.appendChild(counter);
        }

        function loadManualData() {
            const testGames = [
                {
                    id: 1382,
                    title: "Natural Disaster Survival (2016)",
                    description: "Quickly, run around in circles! Your life depends on it!"
                },
                {
                    id: 2535,
                    title: "Jailbreak",
                    description: "Be a criminal or a police officer!"
                }
            ];
            
            const gamesList = document.getElementById('games-list');
            displayGames(testGames, gamesList);
            updateStatus('‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ', 'success');
        }

        function handleGameLaunch(event, gameId) {
            event.preventDefault();
            const robloxUrl = `robloxmobile://Game/PlaceLauncher.ashx?request=RequestGame&placeId=${gameId}`;
            window.location.href = robloxUrl;
            
            setTimeout(() => {
                if (!document.hidden) {
                    const webUrl = `https://www.roblox.com/games/${gameId}/`;
                    const openInBrowser = confirm('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Roblox –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ?');
                    if (openInBrowser) {
                        window.open(webUrl, '_blank');
                    }
                }
            }, 1000);
        }

        document.addEventListener('DOMContentLoaded', loadGames);
    </script>
</body>
</html>